/* CSS 自定義屬性 (顏色變量) - 與上一版相同 */
:root {
  /* 淺色主題 (預設) */
  --body-bg: #f4f7f6;
  --text-primary: #333333;
  --text-secondary: #555555;
  --text-subtitle: #777777;
  --h1-color: #222222;
  --code-tag-color: #777777;
  --profile-border: rgba(0, 0, 0, 0.08);
  --profile-shadow1: rgba(0, 0, 0, 0.08);
  --profile-shadow2: rgba(0,0,0,0.03);
  --icon-link-shadow: rgba(0,0,0,0.1);
  --icon-link-hover-shadow: rgba(0,0,0,0.15);
  --menu-bar-color: #333333;
  --nav-bg: rgba(248, 249, 250, 0.95);
  --nav-link-color: #333333;
  --nav-link-hover-bg: rgba(0,0,0,0.05);
  --nav-link-hover-color: #000000;
  --modal-bg: #ffffff;
  --modal-overlay-bg: rgba(0,0,0,0.4);
  --modal-text-color: #555555;
  --modal-h2-color: #333333;
  --close-button-color: #888;
  --close-button-hover-color: #333;
  --theme-toggle-icon-color: #4a4a4a;
  --theme-toggle-hover-bg: rgba(0,0,0,0.05);
  --discord-bg: #5865F2;
  --github-bg: #333;
  --globe-bg: #007bff;
}

body.dark-theme {
  /* 深色主題 - 與上一版相同 */
  --body-bg: #282c34;
  --text-primary: #e0e0e0;
  --text-secondary: #dadada;
  --text-subtitle: #b5b5b5;
  --h1-color: #ffffff;
  --code-tag-color: #909090;
  --profile-border: rgba(255, 255, 255, 0.1);
  --profile-shadow1: rgba(0, 0, 0, 0.25);
  --profile-shadow2: rgba(0,0,0,0.08);
  --icon-link-shadow: rgba(0,0,0,0.15);
  --icon-link-hover-shadow: rgba(0,0,0,0.25);
  --menu-bar-color: #e0e0e0;
  --nav-bg: rgba(40, 44, 52, 0.95);
  --nav-link-color: #e0e0e0;
  --nav-link-hover-bg: rgba(255,255,255,0.05);
  --nav-link-hover-color: #ffffff;
  --modal-bg: #2c313a;
  --modal-overlay-bg: rgba(0,0,0,0.6);
  --modal-text-color: #c0c0c0;
  --modal-h2-color: #ffffff;
  --close-button-color: #aaa;
  --close-button-hover-color: #e0e0e0;
  --theme-toggle-icon-color: #e0e0e0;
  --theme-toggle-hover-bg: rgba(255,255,255,0.1);
  --github-bg: #333;
}

body {
  margin: 0;
  font-weight: 400;
  background-color: var(--body-bg);
  color: var(--text-primary);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  min-height: 100vh;
  padding: 30px;
  box-sizing: border-box;
  overflow-x: hidden;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* --- Top Right Controls --- */
.top-right-controls {
  position: fixed; /* 確保它固定在右上角 */
  top: 25px;
  right: 25px;
  z-index: 1001; /* 比 main-nav 低，但比一般內容高 */
  display: flex;
  gap: 15px;
  align-items: center;
}

.theme-toggle {
  background: none; border: none;
  color: var(--theme-toggle-icon-color);
  font-size: 1.3em; padding: 8px; cursor: pointer;
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  transition: background-color 0.2s ease, color 0.2s ease, transform 0.3s ease; /* Added transform */
}
.theme-toggle:hover { background-color: var(--theme-toggle-hover-bg); }
/* 圖示旋轉動畫 - 確保 FontAwesome 圖示是 i 標籤 */
.theme-toggle i { transition: transform 0.4s ease-in-out; }
body.dark-theme .theme-toggle i.fa-sun { transform: rotate(180deg); }
body:not(.dark-theme) .theme-toggle i.fa-moon { transform: rotate(0deg); } /* For reset if needed */


.menu-toggle {
  background: none; border: none; padding: 0; cursor: pointer;
  width: 30px; height: 22px;
  display: flex; flex-direction: column; justify-content: space-between; /* 確保與 .top-right-controls 的 z-index 協調 */
  /* z-index 在 .top-right-controls 中已設定 */
}
.hamburger-bar {
  width: 100%; height: 3px;
  background-color: var(--menu-bar-color);
  border-radius: 3px; transition: all 0.3s ease-in-out;
}
.menu-toggle.is-active .hamburger-bar:nth-child(1) { transform: translateY(9.5px) rotate(45deg); }
.menu-toggle.is-active .hamburger-bar:nth-child(2) { opacity: 0; }
.menu-toggle.is-active .hamburger-bar:nth-child(3) { transform: translateY(-9.5px) rotate(-45deg); }

/* === Main Navigation Menu (修正 z-index) === */
.main-nav {
  position: fixed; top: 0; right: -300px; width: 280px; height: 100vh;
  background-color: var(--nav-bg);
  backdrop-filter: blur(5px); box-shadow: -5px 0 15px rgba(0,0,0,0.1);
  padding-top: 80px;
  z-index: 1000; /* 確保比 .top-right-controls 的按鈕低，但比頁面內容高。
                      當選單打開時，JS 會使其可見，並且它應該在最上層（除了 modal）。
                      如果 .top-right-controls 的 z-index 是 1001，那麼選單打開時，
                      漢堡按鈕本身（X狀態）會在其之上，這是正常的。*/
  transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), background-color 0.3s ease;
  overflow-y: auto;
}
.main-nav.is-open {
  right: 0;
  /* z-index: 1000; 保持 z-index，它應該能正常顯示 */
}
/* 其餘 .main-nav 內部樣式不變 */
.main-nav ul { list-style: none; padding: 0; margin: 0; }
.main-nav ul li {
  opacity: 0; transform: translateX(20px);
  transition: opacity 0.3s ease-out, transform 0.3s ease-out;
}
.main-nav.is-open ul li { opacity: 1; transform: translateX(0); }
.main-nav.is-open ul li:nth-child(1) { transition-delay: 0.1s; }
.main-nav.is-open ul li:nth-child(2) { transition-delay: 0.15s; }
.main-nav.is-open ul li:nth-child(3) { transition-delay: 0.2s; }
.main-nav ul li a {
  display: block; padding: 18px 30px; font-size: 1.1em; font-weight: 500;
  color: var(--nav-link-color);
  text-decoration: none;
  transition: background-color 0.2s ease, color 0.2s ease, padding-left 0.2s ease;
}
.main-nav ul li a:hover, .main-nav ul li a:focus {
  background-color: var(--nav-link-hover-bg);
  color: var(--nav-link-hover-color);
  padding-left: 35px;
}


/* --- 其餘 CSS (Container, Animations, Info Section, Headings, Social Icons, Profile, Modal) --- */
/* 確保這些部分的顏色已正確使用 CSS 變量 */

.container {
  display: flex; align-items: center; justify-content: center;
  width: 100%; max-width: 1050px; gap: 50px;
  flex: 1;
}
/* ... (fadeInSlideUp animation) ... */
@keyframes fadeInSlideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

.info-section { flex: 1; max-width: 650px; }
.info-section > h1, .info-section > h2, .info-section > .subtitle, .info-section > .social-icons {
  opacity: 0; animation: fadeInSlideUp 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
}
.info-section > h1 { animation-delay: 0.2s; }
.info-section > h2 { animation-delay: 0.8s; }
.info-section > .subtitle { animation-delay: 1.0s; }
.info-section > .social-icons { animation-delay: 1.2s; }

h1 {
  font-size: 3.2em; margin-bottom: 0.3em; color: var(--h1-color);
  font-weight: 700; line-height: 1.2; min-height: 50px;
}
.typed-cursor {
  color: var(--text-primary); opacity: 1;
  animation: typedjsBlink 0.7s infinite !important;
  display: inline-block; font-weight: normal; margin-left: 1px;
}
@keyframes typedjsBlink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
h2 {
  font-size: 2.3em; font-weight: 700; margin-top: 0; margin-bottom: 1em;
  color: var(--text-secondary);
  white-space: nowrap;
}
.code-tag { font-family: monospace; color: var(--code-tag-color); }
.subtitle { font-size: 1.15em; color: var(--text-subtitle); margin-bottom: 2.5em; line-height: 1.6; }
.social-icons { display: flex; gap: 18px; }
.icon-link {
  display: inline-flex; justify-content: center; align-items: center;
  width: 46px; height: 46px; border-radius: 50%; color: white;
  text-decoration: none; font-size: 1.35em; box-shadow: 0 2px 5px var(--icon-link-shadow);
  transition: opacity 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease;
}
.icon-link:hover { opacity: 1; transform: translateY(-3px) scale(1.1); box-shadow: 0 5px 12px var(--icon-link-hover-shadow); }
#icon-discord { background-color: var(--discord-bg); }
#icon-github { background-color: var(--github-bg); }
#icon-globe { background-color: var(--globe-bg); }
.profile-image-section {
  flex-shrink: 0; opacity: 0; animation: fadeInSlideUp 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; animation-delay: 0.4s;
}
.profile-image-section img {
  width: 300px; height: 300px; border-radius: 50%; object-fit: cover;
  border: 3px solid var(--profile-border);
  box-shadow: 0 8px 25px var(--profile-shadow1), 0 0 0 5px var(--profile-shadow2);
  transition: transform 0.35s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.35s ease;
}
.profile-image-section img:hover { transform: scale(1.06) rotate(2deg); box-shadow: 0 12px 35px var(--profile-shadow1), 0 0 0 7px var(--profile-shadow2); }

.no-scroll { overflow: hidden; }

.modal {
  display: none; position: fixed; z-index: 1002; /* Modal 應該在最上層 */
  left: 0; top: 0; width: 100%; height: 100%; overflow: auto;
  background-color: var(--modal-overlay-bg);
  align-items: center; justify-content: center; padding: 20px; box-sizing: border-box;
  transition: background-color 0.3s ease;
}
.modal-content {
  background-color: var(--modal-bg); margin: auto; padding: 30px; border-radius: 8px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15); width: 90%; max-width: 600px; position: relative;
  opacity: 0; transform: scale(0.95) translateY(10px); transition: background-color 0.3s ease;
}
/* ... (Modal animations and other modal styles) ... */
.modal-content.modal-animate-in { animation: modalFadeInScaleUp 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
.modal-content.modal-animate-out { animation: modalFadeOutScaleDown 0.3s cubic-bezier(0.55, 0.085, 0.68, 0.53) forwards; }
@keyframes modalFadeInScaleUp { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
@keyframes modalFadeOutScaleDown { from { opacity: 1; transform: scale(1) translateY(0); } to { opacity: 0; transform: scale(0.95) translateY(10px); } }
.modal-content h2 { color: var(--modal-h2-color); margin-top: 0; margin-bottom: 20px; font-weight: 700; }
.modal-content p, .modal-content ul { color: var(--modal-text-color); line-height: 1.7; margin-bottom: 15px; }
.modal-content ul { padding-left: 20px; }
.modal-content li { margin-bottom: 8px; }
.close-button {
  color: var(--close-button-color); position: absolute; top: 15px; right: 20px;
  font-size: 28px; font-weight: bold; transition: color 0.2s ease;
}
.close-button:hover, .close-button:focus { color: var(--close-button-hover-color); text-decoration: none; cursor: pointer; }


/* Responsive adjustments */
@media (max-width: 820px) {
  .container { flex-direction: column; text-align: center; gap: 30px; }
  .info-section { order: 2; max-width: 100%; }
  .social-icons { justify-content: center; }
  .profile-image-section { order: 1; margin-bottom: 20px; }
  .top-right-controls { top: 20px; right: 20px; } /* 保持位置 */
  .main-nav { padding-top: 70px; }
  h1 { font-size: 2.4em; }
  h2 { font-size: 1.7em; }
  .subtitle { font-size: 0.95em; }
  .profile-image-section img { width: 220px; height: 220px; }
}
@media (max-width: 480px) {
  body { padding: 20px; }
  .top-right-controls { top: 15px; right: 15px; gap: 10px; } /* 保持位置 */
  .theme-toggle { font-size: 1.2em; padding: 6px;}
  .menu-toggle { width: 28px; height: 20px;}
  .menu-toggle.is-active .hamburger-bar:nth-child(1) { transform: translateY(8.5px) rotate(45deg); }
  .menu-toggle.is-active .hamburger-bar:nth-child(3) { transform: translateY(-8.5px) rotate(-45deg); }
  h1 { font-size: 2em; }
  h2 { font-size: 1.5em; }
  .subtitle { font-size: 0.9em; }
  .profile-image-section img { width: 180px; height: 180px; }
  .icon-link { width: 36px; height: 36px; font-size: 1.1em; }
  .main-nav { width: 250px; right: -270px; }
}

footer {
  text-align: center;
  margin: 2em 0 1em 0;
  color: #aaa;
  font-size: 0.95em;
  width: 100%;
  margin-top: auto;
}
